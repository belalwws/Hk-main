# دليل نظام السحب والإفلات لإعدادات الشهادة

## 🎯 النظام الجديد

تم إنشاء واجهة تفاعلية تسمح للأدمن بتحديد موضع الاسم على الشهادة بطريقة بصرية سهلة!

## ✨ المميزات الجديدة

### 1. **واجهة السحب والإفلات**
- اضغط في أي مكان على الشهادة لتحديد موضع الاسم
- شريط تمرير للضبط الدقيق
- معاينة فورية للتغييرات
- خط أحمر متقطع يظهر موضع الاسم

### 2. **حفظ الإعدادات للجميع**
- إعدادات موحدة لجميع المستخدمين
- تطبيق فوري على جميع الشهادات الجديدة
- حفظ آمن في قاعدة البيانات

### 3. **معاينة تفاعلية**
- تغيير اسم المعاينة لاختبار أسماء مختلفة
- رؤية النتيجة النهائية قبل الحفظ
- إمكانية إعادة التعيين للإعدادات الافتراضية

## 🚀 كيفية الاستخدام

### الخطوة 1: الوصول للإعدادات
```
/admin/dashboard → إعدادات الشهادة
```

### الخطوة 2: تحديد الموضع
1. **بالنقر**: اضغط في أي مكان على الشهادة
2. **بالشريط**: استخدم شريط التمرير للضبط الدقيق
3. **بالنص**: غير اسم المعاينة لاختبار أسماء مختلفة

### الخطوة 3: الحفظ
1. اضغط "حفظ الإعدادات"
2. ستظهر رسالة تأكيد
3. الإعدادات ستطبق على جميع الشهادات الجديدة

## 📍 الملفات المضافة

### 1. **API Endpoint**
- `app/api/admin/certificate-settings/route.ts`
- GET: جلب الإعدادات الحالية
- POST: حفظ إعدادات جديدة

### 2. **صفحة الإعدادات**
- `app/admin/certificate-settings/page.tsx`
- واجهة تفاعلية للتحكم في الموضع
- معاينة فورية مع Canvas

### 3. **ملف التكوين المحدث**
- `lib/certificate-config.ts`
- دعم الإعدادات المخصصة
- قراءة من API

### 4. **مكون الشهادة المحدث**
- `components/Certificate.tsx`
- قراءة الإعدادات من API
- تطبيق الإعدادات المخصصة

## ⚙️ الإعدادات المتاحة

### موضع الاسم
```typescript
namePosition: 0.52  // 52% من ارتفاع الشهادة
// 0.2 = أعلى الشهادة
// 0.5 = وسط الشهادة  
// 0.8 = أسفل الشهادة
```

### خط الاسم
```typescript
nameFont: 'bold 48px Arial'
// يمكن تغيير الحجم والنوع
```

### لون الاسم
```typescript
nameColor: '#1a472a'  // أخضر داكن
// يمكن استخدام أي لون hex
```

## 🔄 تدفق العمل

### للأدمن:
1. **إعداد أولي**: تحديد موضع الاسم مرة واحدة
2. **اختبار**: معاينة مع أسماء مختلفة
3. **حفظ**: تطبيق على جميع المستخدمين

### للمستخدمين:
1. **تلقائي**: الشهادات تستخدم الإعدادات المحفوظة
2. **شفاف**: لا يحتاجون فعل أي شيء
3. **موحد**: جميع الشهادات بنفس التنسيق

## 🛠️ التخصيص المتقدم

### إضافة إعدادات جديدة:
```typescript
// في certificate-settings API
interface CertificateSettings {
  namePosition: number
  nameFont: string
  nameColor: string
  // يمكن إضافة المزيد هنا
  nameSize?: number
  nameStyle?: string
}
```

### تعديل الواجهة:
```typescript
// في certificate-settings page
// يمكن إضافة المزيد من عناصر التحكم
<input type="color" value={settings.nameColor} />
<select value={settings.nameFont}>
  <option>Arial</option>
  <option>Times New Roman</option>
</select>
```

## 🎨 التصميم

### الألوان المستخدمة:
- **الأساسي**: `#01645e` (أخضر داكن)
- **الثانوي**: `#3ab666` (أخضر متوسط)
- **المميز**: `#c3e956` (أخضر فاتح)

### الأيقونات:
- **الإعدادات**: ⚙️ Settings
- **الحفظ**: 💾 Save
- **إعادة التعيين**: 🔄 RotateCcw
- **المعاينة**: 👁️ Eye

## 📱 الاستجابة

### الأجهزة المدعومة:
- **سطح المكتب**: تجربة كاملة
- **التابلت**: واجهة متكيفة
- **الهاتف**: تخطيط عمودي

### المتصفحات:
- Chrome ✅
- Firefox ✅
- Safari ✅
- Edge ✅

## 🔒 الأمان

### التحقق من الصلاحيات:
```typescript
// فقط الأدمن يمكنه الوصول
if (user.role !== 'admin') {
  router.push('/admin/dashboard')
  return
}
```

### التحقق من البيانات:
```typescript
// التأكد من صحة موضع الاسم
if (namePosition < 0 || namePosition > 1) {
  return error('موضع غير صحيح')
}
```

## 🚨 استكشاف الأخطاء

### إذا لم تظهر الشهادة:
1. تحقق من وجود `public/row-certificat.png`
2. تحقق من console للأخطاء
3. تأكد من تحميل الصورة بنجاح

### إذا لم تحفظ الإعدادات:
1. تحقق من صلاحيات الكتابة
2. تحقق من API endpoint
3. راجع logs الخادم

### إذا لم تطبق الإعدادات:
1. تأكد من حفظ الإعدادات أولاً
2. أعد تحميل الصفحة
3. تحقق من cache المتصفح

## 🎉 النتيجة النهائية

الآن يمكن للأدمن:
- **تحديد موضع الاسم بصرياً** بالنقر على الشهادة
- **ضبط دقيق** باستخدام شريط التمرير
- **معاينة فورية** للتغييرات
- **حفظ للجميع** بضغطة واحدة
- **اختبار أسماء مختلفة** قبل الحفظ

النظام سهل، بصري، وفعال! 🚀
